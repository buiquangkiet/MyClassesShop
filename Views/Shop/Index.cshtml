@model MyClassesShop.ViewModels.HomeViewModel
@{
    ViewData["Title"] = "Trang chủ";
}
<div class="container py-4">

    <!-- Carousel Banner quảng cáo -->
    <div id="promoBanner" class="carousel slide mb-5" data-bs-ride="carousel">
        <div class="carousel-inner rounded shadow">
            <div class="carousel-item active">
                <img src="https://kinhhaitrieu.com/wp-content/uploads/2024/04/mat-kinh-gucci-chinh-hang-banner.jpg"  class="banner-img" alt="Khuyến mãi 1">
            </div>
            <div class="carousel-item">
                <img src="https://baodongnai.com.vn/file/e7837c02876411cd0187645a2551379f/042024/100_20240402161010.jpg"  class=" banner-img"  alt="Khuyến mãi 2">
            </div>
            <div class="carousel-item">
                <img src="https://i.ytimg.com/vi/LDXENhpaFfI/maxresdefault.jpg" class="banner-img" alt="Khuyến mãi 3">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#promoBanner" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#promoBanner" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>


    <!-- Slide sản phẩm nổi bật -->
    <section class="mb-5">
        <h2 class="fw-bold mb-4 text-primary">🔥 Sản phẩm nổi bật</h2>
        <div id="featuredCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                @for (int i = 0; i < Model.FeaturedProducts.Count; i++)
                {
                    var product = Model.FeaturedProducts[i];
                    var images = product.ImageUrl?.Split(';', StringSplitOptions.RemoveEmptyEntries) ?? new string[0];

                    <div class="carousel-item @(i == 0 ? "active" : "")">
                        <div class="row align-items-center">
                            <div class="col-md-6 text-center">
                                <img src="@images.FirstOrDefault()" class="img-fluid" style="max-height: 350px; object-fit: contain;" />
                            </div>
                            <div class="col-md-6 text-white bg-dark bg-opacity-75 p-4 rounded">
                                <h3>@product.Name</h3>
                                <p class="lead text-warning">@product.Price.ToString("N0") ₫</p>
                                <a asp-controller="Shop" asp-action="Details" asp-route-id="@product.ProductId" class="btn btn-outline-light me-2">Xem chi tiết</a>
                                <form asp-controller="Cart" asp-action="AddToCart" method="post" class="d-inline">
                                    <input type="hidden" name="productId" value="@product.ProductId" />
                                    <button type="submit" class="btn btn-warning">Thêm vào giỏ</button>
                                </form>
                            </div>
                        </div>
                    </div>
                }
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#featuredCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#featuredCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
            </button>
        </div>
    </section>

    <!-- Bộ lọc sản phẩm -->
    <form method="get" class="row mb-4 g-2">
        <div class="col-md-3">
            <select name="categoryId" class="form-select">
                <option value="">-- Tất cả danh mục --</option>
                @foreach (var category in Model.Categories)
                {
                    <option value="@category.CategoryId" selected="@(category.CategoryId == Model.SelectedCategoryId)">
                        @category.Name
                    </option>
                }
            </select>
        </div>
        <div class="col-md-3">
            <select name="color" class="form-select">
                <option value="">-- Tất cả màu --</option>
                @foreach (var color in Model.Colors)
                {
                    <option value="@color" selected="@(color == Model.SelectedColor)">@color</option>
                }
            </select>
        </div>
        <div class="col-md-3">
            <select name="type" class="form-select">
                <option value="">-- Tất cả loại --</option>
                @foreach (var type in Model.Types)
                {
                    <option value="@type" selected="@(type == Model.SelectedType)">@type</option>
                }
            </select>
        </div>
        <div class="col-md-3 d-grid">
            <button type="submit" class="btn btn-primary">🔍 Lọc sản phẩm</button>
        </div>
    </form>

    <!-- Danh sách tất cả sản phẩm -->
    <section>
        <h2 class="fw-bold mb-4 text-success">🛍️ Tất cả sản phẩm</h2>
        <div class="row">
            @foreach (var product in Model.AllProducts)
            {
                var images = product.ImageUrl?.Split(';', StringSplitOptions.RemoveEmptyEntries) ?? new string[0];
                <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                    <div class="card h-100 shadow-sm border-0">
                        @if (images.Length > 0)
                        {
                            <div id="carousel-@product.ProductId" class="carousel slide" data-bs-ride="carousel">
                                <div class="carousel-inner">
                                    @for (int j = 0; j < images.Length; j++)
                                    {
                                        <div class="carousel-item @(j == 0 ? "active" : "")">
                                            <img src="@images[j]" class="d-block w-100" style="height: 200px; object-fit: contain;" />
                                        </div>
                                    }
                                </div>
                                <button class="carousel-control-prev" type="button" data-bs-target="#carousel-@product.ProductId" data-bs-slide="prev">
                                    <span class="carousel-control-prev-icon"></span>
                                </button>
                                <button class="carousel-control-next" type="button" data-bs-target="#carousel-@product.ProductId" data-bs-slide="next">
                                    <span class="carousel-control-next-icon"></span>
                                </button>
                            </div>
                        }
                        <div class="card-body d-flex flex-column">
                            <h6 class="fw-bold">@product.Name</h6>
                            <p class="text-danger fw-semibold">@product.Price.ToString("N0") ₫</p>
                            <div class="mt-auto">
                                <a asp-controller="Shop" asp-action="Details" asp-route-id="@product.ProductId"
                                   class="btn btn-sm btn-outline-primary w-100 mb-2">Xem chi tiết</a>
                                <form asp-controller="Cart" asp-action="AddToCart" method="post">
                                    <input type="hidden" name="productId" value="@product.ProductId" />
                                    <button type="submit" class="btn btn-sm btn-outline-success w-100">🛒 Thêm vào giỏ</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </section>

</div>
